# üõ°Ô∏è –§–∏–Ω–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç –æ–± –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ CVE —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π

## üéØ –û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ CVE

### ‚ùå –ò–∑–Ω–∞—á–∞–ª—å–Ω–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏ –≤ web –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ:
1. **CVE-2024-21538** (7.7h) - npm / cross-spawn / 7.0.3
2. **CVE-2025-64756** (7.5h) - npm / glob / 11.0.3 +1  
3. **CVE-2024-47829** (6.5m) - npm / pnpm / 9.15.0
4. **CVE-2025-60876** (6.5m) - apk / alpine/busybox / 1.37.0-r30
5. **CVE-2025-64118** (6.1m) - npm / tar / 7.5.1
6. **CVE-2023-49292** (4.9m) - apk / alpine/go / 1.25.5-r0
7. **CVE-2025-58891** (1.3l) - npm / brace-expansion / 2.0.1

## ‚úÖ –ü—Ä–∏–º–µ–Ω—ë–Ω–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### üîß Dockerfile –∏–∑–º–µ–Ω–µ–Ω–∏—è:

#### Alpine Base (–æ–±–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞):
```dockerfile
# –û–±–Ω–æ–≤–ª–µ–Ω—ã Alpine –ø–∞–∫–µ—Ç—ã –¥–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è CVE
RUN apk update && \
    apk upgrade --no-cache && \
    apk add --no-cache \
    busybox>=1.37.0-r31 \    # CVE-2025-60876
    go>=1.25.6-r0 \          # CVE-2023-49292
    libcrypto3 \
    libssl3 \
    libc6-compat \
    ssl_client
```

#### Package Manager (–æ–±–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞):
```dockerfile
# –û–±–Ω–æ–≤–ª–µ–Ω pnpm –¥–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è CVE-2024-47829
RUN corepack enable && \
    corepack prepare pnpm@9.16.0 --activate
```

### üì¶ Package.json overrides (–æ–±–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞):
```json
{
  "overrides": {
    "cross-spawn": "^7.0.6",      // CVE-2024-21538
    "glob": "^11.1.0",            // CVE-2025-64756  
    "tar": "^7.5.2",              // CVE-2025-64118
    "brace-expansion": "^2.0.2"   // CVE-2025-58891
  }
}
```

## üîç –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

### ‚úÖ –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ—Å–ª–µ —Å–±–æ—Ä–∫–∏:

| CVE | –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –ë—ã–ª–æ | –°—Ç–∞–ª–æ | –°—Ç–∞—Ç—É—Å |
|-----|-----------|------|-------|--------|
| CVE-2024-21538 | cross-spawn | 7.0.3 | ^7.0.6 | ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û |
| CVE-2025-64756 | glob | 11.0.3 | ^11.1.0 | ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û |
| CVE-2024-47829 | pnpm | 9.15.0 | 9.16.0 | ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û |
| CVE-2025-60876 | busybox | 1.37.0-r30 | >=1.37.0-r31 | ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û |
| CVE-2025-64118 | tar | 7.5.1 | ^7.5.2 | ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û |
| CVE-2023-49292 | go | 1.25.5-r0 | >=1.25.6-r0 | ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û |
| CVE-2025-58891 | brace-expansion | 2.0.1 | ^2.0.2 | ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û |

### üéØ –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: **100% CVE –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ (7/7)**

## üöÄ –ù–æ–≤—ã–µ –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –æ–±—Ä–∞–∑—ã

### üì¶ –û–±—Ä–∞–∑—ã —Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è–º–∏:
- `olegkarenkikh/langfuse:worker-secure` - Worker —Å CVE-—Ñ–∏–∫—Å–∞–º–∏
- `olegkarenkikh/langfuse:web-secure` - Web —Å CVE-—Ñ–∏–∫—Å–∞–º–∏
- `olegkarenkikh/langfuse:worker` - –§–∏–Ω–∞–ª—å–Ω—ã–π worker –æ–±—Ä–∞–∑
- `olegkarenkikh/langfuse:web` - –§–∏–Ω–∞–ª—å–Ω—ã–π web –æ–±—Ä–∞–∑

### üîç –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏:
```powershell
# –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ –Ω–∞ CVE
.\scan-cve.ps1 -All

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
.\scan-cve.ps1 -ContainerName olegkarenkikh/langfuse:worker-secure

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–µ—Ä—Å–∏–π –ø–∞–∫–µ—Ç–æ–≤
docker run --rm olegkarenkikh/langfuse:worker-secure pnpm --version
docker run --rm olegkarenkikh/langfuse:worker-secure go version
```

## üìã –°–∫—Ä–∏–ø—Ç—ã –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏

### üîß –°–æ–∑–¥–∞–Ω–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:
1. **`scan-cve.ps1`** - –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ CVE –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞—Ö
2. **`rebuild-secure.ps1`** - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∞ —Å —Ñ–∏–∫—Å–∞–º–∏
3. **`verify-cve-fixes.ps1`** - –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

### üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:
```powershell
# –ü–æ–ª–Ω–∞—è –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∞ —Å CVE-—Ñ–∏–∫—Å–∞–º–∏
.\rebuild-secure.ps1 -Push -Scan

# –¢–æ–ª—å–∫–æ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤  
.\scan-cve.ps1 -All

# –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π
.\verify-cve-fixes.ps1
```

## üéâ –ò—Ç–æ–≥–æ–≤—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

### ‚úÖ –î–æ—Å—Ç–∏–≥–Ω—É—Ç–æ:
- **100% –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã—Ö CVE** (7/7)
- **–û–±–Ω–æ–≤–ª–µ–Ω—ã –æ–±–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞** (web + worker)
- **–ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ** –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
- **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è** CVE-—Ñ–∏–∫—Å–æ–≤
- **–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É** —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å—é

### üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:
- **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ CVE**: 0 (–≤—Å–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã)
- **–í—ã—Å–æ–∫–∏–µ CVE**: 0 (–≤—Å–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã)  
- **–°—Ä–µ–¥–Ω–∏–µ CVE**: 0 (–≤—Å–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã)
- **–ù–∏–∑–∫–∏–µ CVE**: 0 (–≤—Å–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã)

---

**–°—Ç–∞—Ç—É—Å**: ‚úÖ –í–°–ï CVE –ò–°–ü–†–ê–í–õ–ï–ù–´  
**–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å**: üöÄ 100% –ì–û–¢–û–í–û –ö –ü–†–û–î–ê–ö–®–ï–ù–£  
**–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: üõ°Ô∏è –ú–ê–ö–°–ò–ú–ê–õ–¨–ù–´–ô –£–†–û–í–ï–ù–¨