#1 [internal] load local bake definitions
#1 reading from stdin 1.06kB done
#1 DONE 0.0s

#2 [langfuse-web internal] load build definition from Dockerfile
#2 transferring dockerfile: 7.44kB 0.0s done
#2 WARN: RedundantTargetPlatform: Setting platform to predefined ${TARGETPLATFORM:-linux/amd64} in FROM is redundant as this is the default behavior (line 4)
#2 DONE 0.0s

#3 [langfuse-worker internal] load build definition from Dockerfile
#3 transferring dockerfile: 5.67kB 0.0s done
#3 DONE 0.0s

#4 [langfuse-worker internal] load metadata for docker.io/library/node:24-alpine
#4 DONE 0.6s

#5 [langfuse-web internal] load .dockerignore
#5 transferring context: 131B 0.0s done
#5 DONE 0.0s

#6 [langfuse-worker alpine 1/2] FROM docker.io/library/node:24-alpine@sha256:c921b97d4b74f51744057454b306b418cf693865e73b8100559189605f6955b8
#6 DONE 0.0s

#7 [langfuse-worker runner 1/6] RUN apk add --no-cache dumb-init
#7 CACHED

#8 [langfuse-worker runner 2/6] WORKDIR /app
#8 CACHED

#9 [langfuse-worker runner 3/6] RUN addgroup --system --gid 1001 expressjs &&     adduser --system --uid 1001 expressjs
#9 CACHED

#10 [langfuse-web base 1/2] RUN npm install turbo@^2.7.1 --global
#10 CACHED

#11 [langfuse-web runner  5/16] RUN if [ -n "" ]; then       npm install --no-package-lock --no-save dd-trace@5.81.0;     fi
#11 CACHED

#12 [langfuse-web base 2/2] RUN corepack enable &&     corepack prepare pnpm@9.5.0 --activate
#12 CACHED

#13 [langfuse-web runner  3/16] RUN addgroup --system --gid 1001 nodejs &&     adduser --system --uid 1001 nextjs
#13 CACHED

#14 [langfuse-web alpine 2/2] RUN apk update &&     apk upgrade --no-cache     libcrypto3     libssl3     libc6-compat     busybox     ssl_client
#14 CACHED

#15 [langfuse-web pruner 1/7] WORKDIR /app
#15 CACHED

#16 [langfuse-web runner  2/16] RUN apk add --no-cache dumb-init tzdata
#16 CACHED

#17 [langfuse-web runner  4/16] RUN npm install -g --no-package-lock --no-save prisma@7.2.0
#17 CACHED

#18 [langfuse-web runner  6/16] RUN MIGRATE_TARGET_ARCH=$(echo linux/amd64 | sed 's/\//-/g') &&     wget -q -O- https://github.com/golang-migrate/migrate/releases/download/v4.19.0/migrate.$MIGRATE_TARGET_ARCH.tar.gz | tar xvz &&     mv migrate /usr/bin/migrate
#18 CACHED

#19 [langfuse-web internal] load build context
#19 transferring context: 351.89kB 3.2s done
#19 DONE 3.2s

#20 [langfuse-web kysely-builder 7/8] RUN ls -la dist/cjs/index.js dist/esm/index.js ||     (echo "❌ Kysely build failed" && exit 1)
#20 CACHED

#21 [langfuse-web kysely-builder 8/8] RUN rm -rf node_modules test site example docs .github
#21 CACHED

#22 [langfuse-worker kysely-builder 4/8] RUN sed -i 's|git://github.com/kysely-org/kysely.git|https://github.com/OlegKarenkikh/kysely.git|' package.json
#22 CACHED

#23 [langfuse-worker kysely-builder 3/8] RUN git clone https://github.com/OlegKarenkikh/kysely.git . &&     git checkout 64a12c470b1a5387b842acf09094e2aa1e4149b0
#23 CACHED

#24 [langfuse-worker kysely-builder 7/8] RUN ls -la dist/cjs/index.js dist/esm/index.js ||     (echo "❌ Kysely build failed: dist files not found" && exit 1)
#24 CACHED

#25 [langfuse-worker kysely-builder 5/8] RUN npm install --no-save typescript@~5.9.3 --ignore-scripts
#25 CACHED

#26 [langfuse-worker kysely-builder 1/8] RUN apk add --no-cache git
#26 CACHED

#27 [langfuse-worker kysely-builder 2/8] WORKDIR /kysely
#27 CACHED

#28 [langfuse-worker kysely-builder 6/8] RUN npx tsc -p tsconfig.json &&     npx tsc -p tsconfig-cjs.json
#28 CACHED

#15 [langfuse-worker pruner 1/7] WORKDIR /app
#15 CACHED

#29 [langfuse-worker kysely-builder 8/8] RUN rm -rf node_modules test site example docs .github
#29 CACHED

#30 [langfuse-web pruner 2/7] COPY . .
#30 DONE 13.1s

#31 [langfuse-worker pruner 3/7] RUN rm -rf packages/kysely
#31 DONE 8.0s

#32 [langfuse-web pruner 4/7] COPY --from=kysely-builder /kysely ./packages/kysely
#32 DONE 7.4s

#33 [langfuse-web pruner 5/7] RUN node -e "try {       JSON.parse(require('fs').readFileSync('./packages/kysely/package.json', 'utf8'));       console.log('✅ kysely package.json is valid');     } catch(e) {       console.error('❌ Invalid kysely package.json:', e.message);       process.exit(1);     }"
#33 8.455 ✅ kysely package.json is valid
#33 DONE 8.5s

#34 [langfuse-worker pruner 6/7] RUN pnpm install --lockfile-only || true
#34 11.09 web                                      |  WARN  The field "pnpm" was found in /app/web/package.json. This will not take effect. You should configure "pnpm" at the root of the workspace instead.
#34 11.21 Scope: all 8 workspace projects
#34 11.28 (node:7) [DEP0169] DeprecationWarning: `url.parse()` behavior is not standardized and prone to errors that have security implications. Use the WHATWG URL API instead. CVEs are not issued for `url.parse()` vulnerabilities.
#34 11.28 (Use `node --trace-deprecation ...` to show where the warning was created)
#34 12.42 Progress: resolved 1, reused 0, downloaded 0, added 0
#34 13.02
#34 13.02    ╭───────────────────────────────────────────────────────────────────╮
#34 13.02    │                                                                   │
#34 13.02    │                Update available! 9.5.0 → 10.27.0.                 │
#34 13.02    │   Changelog: https://github.com/pnpm/pnpm/releases/tag/v10.27.0   │
#34 13.02    │         Run "corepack install -g pnpm@10.27.0" to update.         │
#34 13.02    │                                                                   │
#34 13.02    │         Follow @pnpmjs for updates: https://x.com/pnpmjs          │
#34 13.02    │                                                                   │
#34 13.02    ╰───────────────────────────────────────────────────────────────────╯
#34 13.02
#34 13.16 ee                                       |  WARN  deprecated eslint@8.57.1
#34 13.47 Progress: resolved 18, reused 0, downloaded 0, added 0
#34 14.48 Progress: resolved 28, reused 0, downloaded 0, added 0
#34 15.48 Progress: resolved 47, reused 0, downloaded 0, added 0
#34 16.49 Progress: resolved 66, reused 0, downloaded 0, added 0
#34 17.03 web                                      |  WARN  deprecated @types/dompurify@3.2.0
#34 17.50 Progress: resolved 79, reused 0, downloaded 0, added 0
#34 18.53 Progress: resolved 115, reused 0, downloaded 0, added 0
#34 19.53 Progress: resolved 150, reused 0, downloaded 0, added 0
#34 21.44 Progress: resolved 193, reused 0, downloaded 0, added 0
#34 22.46 Progress: resolved 213, reused 0, downloaded 0, added 0
#34 23.87 Progress: resolved 250, reused 0, downloaded 0, added 0
#34 23.91 packages/kysely                          |  WARN  deprecated chai-subset@1.6.0
#34 24.89 Progress: resolved 268, reused 0, downloaded 0, added 0
#34 26.28 Progress: resolved 270, reused 0, downloaded 0, added 0
#34 27.63 Progress: resolved 326, reused 0, downloaded 0, added 0
#34 28.74 Progress: resolved 353, reused 0, downloaded 0, added 0
#34 29.74 Progress: resolved 391, reused 0, downloaded 0, added 0
#34 30.74 Progress: resolved 436, reused 0, downloaded 0, added 0
#34 31.76 Progress: resolved 506, reused 0, downloaded 0, added 0
#34 32.89 Progress: resolved 595, reused 0, downloaded 0, added 0
#34 33.90 Progress: resolved 705, reused 0, downloaded 0, added 0
#34 34.90 Progress: resolved 807, reused 0, downloaded 0, added 0
#34 35.90 Progress: resolved 959, reused 0, downloaded 0, added 0
#34 36.91 Progress: resolved 1157, reused 0, downloaded 0, added 0
#34 37.92 Progress: resolved 1301, reused 0, downloaded 0, added 0
#34 38.92 Progress: resolved 1383, reused 0, downloaded 0, added 0
#34 40.16 Progress: resolved 1447, reused 0, downloaded 0, added 0
#34 41.19 Progress: resolved 1483, reused 0, downloaded 0, added 0
#34 42.23 Progress: resolved 1542, reused 0, downloaded 0, added 0
#34 43.24 Progress: resolved 1597, reused 0, downloaded 0, added 0
#34 44.25 Progress: resolved 1884, reused 0, downloaded 0, added 0
#34 45.25 Progress: resolved 2089, reused 0, downloaded 0, added 0
#34 46.25 Progress: resolved 2368, reused 0, downloaded 0, added 0
#34 47.15 packages/shared                          |  WARN  deprecated puppeteer@23.11.1
#34 47.27 Progress: resolved 2524, reused 0, downloaded 0, added 0
#34 48.64  WARN  11 deprecated subdependencies found: @humanwhocodes/config-array@0.13.0, @humanwhocodes/object-schema@2.0.3, @types/parse-path@7.1.0, abab@2.0.6, domexception@4.0.0, json-schema-ref-parser@6.1.0, lodash.get@4.4.2, node-domexception@1.0.0, rimraf@3.0.2, whatwg-encoding@2.0.0, whatwg-encoding@3.1.1
#34 48.90 Progress: resolved 2591, reused 0, downloaded 0, added 0
#34 48.91 Progress: resolved 2591, reused 0, downloaded 0, added 0, done
#34 48.92
#34 48.92  WARN  Issues with peer dependencies found
#34 48.92 .
#34 48.92 └─┬ prisma 7.2.0
#34 48.92   └─┬ @prisma/studio-core 0.9.0
#34 48.92     ├── ✕ missing peer react@"^18.0.0 || ^19.0.0"
#34 48.92     ├── ✕ missing peer react-dom@"^18.0.0 || ^19.0.0"
#34 48.92     └── ✕ missing peer @types/react@"^18.0.0 || ^19.0.0"
#34 48.92 Peer dependencies that should be installed:
#34 48.92   @types/react@"^18.0.0 || ^19.0.0"
#34 48.92   react-dom@"^18.0.0 || ^19.0.0"
#34 48.92   react@"^18.0.0 || ^19.0.0"
#34 48.92
#34 48.92 packages/shared
#34 48.92 └─┬ prisma-extension-kysely 3.0.0
#34 48.92   └── ✕ unmet peer @prisma/client@latest: found 7.2.0
#34 48.92
#34 48.92 web
#34 48.92 ├─┬ @typescript-eslint/eslint-plugin 6.21.0
#34 48.92 │ └── ✕ unmet peer @typescript-eslint/parser@"^6.0.0 || ^6.0.0-alpha": found 7.18.0
#34 48.92 ├─┬ eslint-config-next 15.5.9
#34 48.92 │ └─┬ @typescript-eslint/eslint-plugin 6.21.0
#34 48.92 │   └── ✕ unmet peer @typescript-eslint/parser@"^6.0.0 || ^6.0.0-alpha": found 7.18.0 in eslint-config-next
#34 48.92 ├─┬ @testing-library/react 15.0.7
#34 48.92 │ ├── ✕ unmet peer @types/react@^18.0.0: found 19.2.2
#34 48.92 │ ├── ✕ unmet peer react@^18.0.0: found 19.2.0
#34 48.92 │ ├── ✕ unmet peer react-dom@^18.0.0: found 19.2.0
#34 48.92 │ └─┬ @types/react-dom 18.3.7
#34 48.92 │   └── ✕ unmet peer @types/react@^18.0.0: found 19.2.2
#34 48.92 └─┬ @tremor/react 4.0.0-beta-tremor-v4.4
#34 48.92   └─┬ react-day-picker 8.10.1
#34 48.92     └── ✕ unmet peer react@"^16.8.0 || ^17.0.0 || ^18.0.0": found 19.2.0
#34 48.92
#34 48.92 worker
#34 48.92 └─┬ prisma 7.2.0
#34 48.92   └─┬ @prisma/studio-core 0.9.0
#34 48.92     ├── ✕ missing peer react@"^18.0.0 || ^19.0.0"
#34 48.92     ├── ✕ missing peer react-dom@"^18.0.0 || ^19.0.0"
#34 48.92     └── ✕ missing peer @types/react@"^18.0.0 || ^19.0.0"
#34 48.92 Peer dependencies that should be installed:
#34 48.92   @types/react@"^18.0.0 || ^19.0.0"
#34 48.92   react-dom@"^18.0.0 || ^19.0.0"
#34 48.92   react@"^18.0.0 || ^19.0.0"
#34 48.92
#34 48.92 Done in 39.2s
#34 DONE 49.1s

#35 [langfuse-worker pruner 4/7] COPY --from=kysely-builder /kysely ./packages/kysely
#35 CACHED

#36 [langfuse-worker pruner 5/7] RUN node -e "try {       JSON.parse(require('fs').readFileSync('./packages/kysely/package.json', 'utf8'));       console.log('✅ kysely package.json is valid');     } catch(e) {       console.error('❌ Invalid kysely package.json:', e.message);       process.exit(1);     }"
#36 CACHED

#37 [langfuse-worker pruner 6/7] RUN pnpm install --lockfile-only || true
#37 CACHED

#38 [langfuse-worker pruner 7/7] RUN turbo prune --scope=worker --docker ||     (echo "❌ Turbo prune failed. Debugging info:" &&      echo "=== turbo.json ===" && cat turbo.json &&      echo "=== worker/package.json ===" && cat worker/package.json &&      exit 1)
#38 ...

#39 [langfuse-web pruner 7/7] RUN turbo prune --scope=web --docker
#39 11.00  WARNING  No locally installed `turbo` found in your repository. Using globally installed version (2.7.2), which can cause unexpected behavior.
#39 11.00
#39 11.00 Installing the version in your repository (^2.7.1) before calling `turbo` will result in more predictable behavior across environments.
#39 11.01
#39 11.01 Attention:
#39 11.01 Turborepo now collects completely anonymous telemetry regarding usage.
#39 11.01 This information is used to shape the Turborepo roadmap and prioritize features.
#39 11.01 You can learn more, including how to opt-out if you'd not like to participate in this anonymous program, by visiting the following URL:
#39 11.01 https://turborepo.com/docs/telemetry
#39 11.01
#39 11.01 • turbo 2.7.2
#39 ...

#38 [langfuse-worker pruner 7/7] RUN turbo prune --scope=worker --docker ||     (echo "❌ Turbo prune failed. Debugging info:" &&      echo "=== turbo.json ===" && cat turbo.json &&      echo "=== worker/package.json ===" && cat worker/package.json &&      exit 1)
#38 11.11  WARNING  No locally installed `turbo` found in your repository. Using globally installed version (2.7.2), which can cause unexpected behavior.
#38 11.11
#38 11.11 Installing the version in your repository (^2.7.1) before calling `turbo` will result in more predictable behavior across environments.
#38 11.12
#38 11.12 Attention:
#38 11.12 Turborepo now collects completely anonymous telemetry regarding usage.
#38 11.12 This information is used to shape the Turborepo roadmap and prioritize features.
#38 11.12 You can learn more, including how to opt-out if you'd not like to participate in this anonymous program, by visiting the following URL:
#38 11.12 https://turborepo.com/docs/telemetry
#38 11.12
#38 11.12 • turbo 2.7.2
#38 11.34 Generating pruned monorepo for worker in /app/out
#38 12.07  - Added @langfuse/shared
#38 12.09  - Added @repo/eslint-config
#38 12.10  - Added @repo/typescript-config
#38 14.05  - Added kysely
#38 14.34  - Added worker
#38 DONE 14.9s

#39 [langfuse-web pruner 7/7] RUN turbo prune --scope=web --docker
#39 11.25 Generating pruned monorepo for web in /app/out
#39 11.26  - Added @langfuse/ee
#39 11.56  - Added @langfuse/shared
#39 11.56  - Added @repo/eslint-config
#39 11.57  - Added @repo/typescript-config
#39 13.61  - Added kysely
#39 14.91  - Added web
#39 DONE 15.4s

#40 [langfuse-worker builder  4/12] COPY --from=pruner /app/out/json/ .
#40 CACHED

#41 [langfuse-worker builder  3/12] COPY --from=pruner /app/out/pnpm-workspace.yaml ./pnpm-workspace.yaml
#41 CACHED

#42 [langfuse-worker builder  5/12] RUN sed -i 's/"preinstall": ".*"/"preinstall": "true"/' package.json
#42 CACHED

#43 [langfuse-worker builder  2/12] COPY --from=pruner /app/out/pnpm-lock.yaml ./pnpm-lock.yaml
#43 CACHED

#44 [langfuse-worker builder  6/12] RUN pnpm install --no-frozen-lockfile
#44 CACHED

#45 [langfuse-worker builder  7/12] COPY --from=pruner /app/out/full/ .
#45 ...

#46 [langfuse-web builder  5/12] RUN sed -i 's/"preinstall": ".*"/"preinstall": "true"/' package.json
#46 CACHED

#47 [langfuse-web builder  2/12] COPY --from=pruner /app/out/pnpm-lock.yaml ./pnpm-lock.yaml
#47 CACHED

#48 [langfuse-web builder  3/12] COPY --from=pruner /app/out/pnpm-workspace.yaml ./pnpm-workspace.yaml
#48 CACHED

#49 [langfuse-web builder  4/12] COPY --from=pruner /app/out/json/ .
#49 CACHED

#50 [langfuse-web builder  6/12] RUN pnpm install --no-frozen-lockfile
#50 CACHED

#51 [langfuse-web builder  7/12] COPY --from=pruner /app/out/full/ .
#51 ...

#45 [langfuse-worker builder  7/12] COPY --from=pruner /app/out/full/ .
#45 DONE 149.9s

#52 [langfuse-worker builder  8/12] RUN npx prisma generate --schema=packages/shared/prisma/schema.prisma
#52 ...

#51 [langfuse-web builder  7/12] COPY --from=pruner /app/out/full/ .
#51 DONE 180.2s

#53 [langfuse-web builder  8/12] RUN rm -f ./web/src/middleware.ts
#53 ...

#52 [langfuse-worker builder  8/12] RUN npx prisma generate --schema=packages/shared/prisma/schema.prisma
#52 67.35 npm warn Unknown project config "public-hoist-pattern". This will stop working in the next major version of npm.
#52 70.30 Prisma schema loaded from packages/shared/prisma/schema.prisma.
#52 75.28
#52 75.28 ✔ Generated Prisma Client (v7.2.0) to ./node_modules/.pnpm/@prisma+client@7.2.0_prisma@7.2.0_@types+react@19.2.2_better-sqlite3@12.5.0_react-dom@19.2.0__e7nvcavy5kz3atq4h4iw6wxtia/node_modules/@prisma/client in 1.02s
#52 75.28
#52 75.28 ✔ Generated Kysely types (1.8.0) to ./packages/shared/prisma/generated in 670ms
#52 75.28
#52 75.28 Start by importing your Prisma Client (See: https://pris.ly/d/importing-client)
#52 75.28
#52 75.28 Tip: Want to turn off tips and other hints? https://pris.ly/tip-4-nohints
#52 75.28
#52 DONE 75.6s

#53 [langfuse-web builder  8/12] RUN rm -f ./web/src/middleware.ts
#53 ...

#54 [langfuse-worker builder  9/12] RUN ls -la node_modules/.prisma/client/index.js ||     (echo "❌ Prisma Client not found" && exit 1)
#54 ...

#53 [langfuse-web builder  8/12] RUN rm -f ./web/src/middleware.ts
#53 DONE 75.3s

#55 [langfuse-web builder  9/12] RUN npx prisma generate --schema=packages/shared/prisma/schema.prisma
#55 ...

#54 [langfuse-worker builder  9/12] RUN ls -la node_modules/.prisma/client/index.js ||     (echo "❌ Prisma Client not found" && exit 1)
#54 57.31 ls: node_modules/.prisma/client/index.js: No such file or directory
#54 57.31 ❌ Prisma Client not found
#54 ERROR: process "/bin/sh -c ls -la node_modules/.prisma/client/index.js ||     (echo \"❌ Prisma Client not found\" && exit 1)" did not complete successfully: exit code: 1

#55 [langfuse-web builder  9/12] RUN npx prisma generate --schema=packages/shared/prisma/schema.prisma
------
 > [langfuse-worker builder  9/12] RUN ls -la node_modules/.prisma/client/index.js ||     (echo "❌ Prisma Client not found" && exit 1):
57.31 ls: node_modules/.prisma/client/index.js: No such file or directory
57.31 ❌ Prisma Client not found
------
Dockerfile:129

--------------------

 128 |     # Verify Prisma Client was generated

 129 | >>> RUN ls -la node_modules/.prisma/client/index.js || \

 130 | >>>     (echo "❌ Prisma Client not found" && exit 1)

 131 |

--------------------

target langfuse-worker: failed to solve: process "/bin/sh -c ls -la node_modules/.prisma/client/index.js ||     (echo \"❌ Prisma Client not found\" && exit 1)" did not complete successfully: exit code: 1
